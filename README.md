# Poolx
åŸºäºGoçš„sync.Poolè¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæ˜¯sync.Poolçš„å¢å¼ºå‹ã€‚

## Features
- èŒƒå‹æ”¯æŒï¼›
- ç¼“å­˜é¢„çƒ­ï¼Œåˆå§‹åŒ–æ—¶é¢„åˆ›å»ºæœ€å¤§æ•°é‡çš„30%å¯¹è±¡æ”¾å…¥Poolä¸­ï¼›
- å¼•ç”¨è®¡æ•°ç»Ÿè®¡(æ´»è·ƒå¯¹è±¡)ï¼›
- å¢å¼ºç›‘æ§èƒ½åŠ›ï¼Œç»Ÿè®¡å¯¹è±¡åˆ†é…æ€»æ•°ã€å¯¹è±¡å¤ç”¨æ€»æ•°ã€å¯¹è±¡ä¸¢å¼ƒæ€»æ•°ï¼›
- å¯¹è±¡æ± å®¹é‡æ§åˆ¶ï¼Œé˜²æ­¢æ— é™å¢é•¿ï¼›
- å¯¹è±¡æ± å®¹é‡åŠ¨æ€æ‰©ç¼©å®¹(å¾…å®ç°)ï¼›

## ğŸš€ Performance
### 1. ç»“æ„ä½“åµŒå¥—Channelçš„å¯¹è±¡
- **ç¡¬ä»¶å¹³å°**ï¼šApple M4èŠ¯ç‰‡ï¼ˆARM64æ¶æ„ï¼‰
- **è½¯ä»¶ç¯å¢ƒ**ï¼šGo 1.23
- **æµ‹è¯•å‚æ•°**ï¼šå•æ ¸è¿è¡Œ/5è½®åŸºå‡†æµ‹è¯•å–å¹³å‡
- **æµ‹è¯•å‘½ä»¤**ï¼š`go test -bench="^BenchmarkPool_Struct$" -cpu=1 -count=5 -benchmem`
- **å¤ç”¨å¯¹è±¡**: 
```go
 type Instance struct {
   Schema string
   Addr   string
   Port   int
   Ch     chan struct{}
 }
```
#### ğŸ“Š æµ‹è¯•ç»“æœ
| è¿­ä»£è½®æ¬¡   | è¿­ä»£æ¬¡æ•°       | å•æ¬¡è€—æ—¶ (ns/op) | å†…å­˜åˆ†é… (B/op) | åˆ†é…æ¬¡æ•° (allocs/op) |
|--------|---------------|------------------|----------------|---------------------|
| 1      | 9,956,271     | 116.9            | 48             | 1                   |
 | 2      | 10,571,440    | 116.0            | 48             | 1                   |
 | 3      | 10,378,336    | 116.5            | 48             | 1                   |
 | 4      | 10,328,274    | 117.3            | 48             | 1                   |
 |      5 | 10,304,106    | 117.1            | 48             | 1                   |
> ğŸ’¡ æµ‹è¯•æ•°æ®æ˜¾ç¤ºå•æ ¸åœºæ™¯ä¸‹ç¨³å®šååé‡è¾¾è¿‘â€‹1000ä¸‡æ¬¡/ç§’

### 2. 1MBå¤§å°çš„byteså¯¹è±¡
- **ç¡¬ä»¶å¹³å°**ï¼šApple M4èŠ¯ç‰‡ï¼ˆARM64æ¶æ„ï¼‰
- **è½¯ä»¶ç¯å¢ƒ**ï¼šGo 1.23
- **æµ‹è¯•å‚æ•°**ï¼šå•æ ¸è¿è¡Œ/5è½®åŸºå‡†æµ‹è¯•å–å¹³å‡
- **æµ‹è¯•å‘½ä»¤**ï¼š`go test -bench="^BenchmarkPool_Big_Bytes$" -cpu=1 -count=5 -benchmem`

#### ğŸ“Š æµ‹è¯•ç»“æœ
| æµ‹è¯•è½®æ¬¡ | è¿­ä»£æ¬¡æ•°      | å•æ¬¡è€—æ—¶ (ns/op) | å†…å­˜åˆ†é… (B/op) | åˆ†é…æ¬¡æ•° (allocs/op) |
|----------|---------------|------------------|-----------------|---------------------|
| 1        | 31,847,030    | 37.85            | 0               | 0                   |
| 2        | 31,781,343    | 37.78            | 0               | 0                   |
| 3        | 31,750,651    | 37.92            | 0               | 0                   |
| 4        | 31,526,954    | 37.85            | 0               | 0                   |
| 5        | 31,675,222    | 37.92            | 0               | 0                   |
> ğŸ’¡ æµ‹è¯•æ•°æ®æ˜¾ç¤ºå•æ ¸åœºæ™¯ä¸‹ç¨³å®šååé‡è¾¾è¿‘â€‹3100å¤šä¸‡æ¬¡/ç§’

## Installation
```bash
go get github.com/TimeWtr/Poolx
```
## Usage
```go
package main

import (
	"time"

	"github.com/TimeWtr/Poolx"
)

func main() {
	pool, err := poolx.NewPool[chan []byte](
		10,
		func() chan []byte {
			return make(chan []byte, 20)
		},
		poolx.WithResetFn[chan []byte](func(ch chan []byte) chan []byte {
			for {
				select {
				case <-ch:
				default:
					return ch
				}
			}
		}),
		poolx.WithCloseFn[chan []byte](func(ch chan []byte) {
			for {
				select {
				case <-ch:
				default:
					close(ch)
					return
				}
			}
		}), poolx.WithMetrics[chan []byte]())
	if err != nil {
		panic(err)
	}
	defer pool.Close()

	obj, err := pool.Get()
	if err != nil {
		panic(err)
	}
	time.Sleep(1 * time.Second)
	pool.Put(obj)
}

```